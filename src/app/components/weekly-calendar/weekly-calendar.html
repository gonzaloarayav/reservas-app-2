<div class="weekly-calendar">
  <!-- Header con navegaci√≥n de semanas -->
  <div class="calendar-header">
    <div class="week-navigation">
      <button class="nav-btn" (click)="previousWeek()">
        <span>‚Äπ</span>
      </button>
      <h2 class="week-range">{{ getCurrentWeekRange() }}</h2>
      <button class="nav-btn" (click)="nextWeek()">
        <span>‚Ä∫</span>
      </button>
    </div>
  </div>

  <!-- Lista de canchas con sus calendarios -->
  <div class="courts-calendar-container">
    <div *ngFor="let court of courts" class="court-section">
      <div class="court-header">
        <h3>{{ court.name }}</h3>
        <span class="court-type">{{ court.type }}</span>
        <span class="court-price">${{ court.pricePerHour }}/hora</span>
      </div>
      
      <!-- Calendario para esta cancha -->
      <div class="court-calendar">
        <!-- Headers de d√≠as -->
        <div class="calendar-grid">
          <div class="time-header">Hora</div>
          <div *ngFor="let day of currentWeek" class="day-header" [class.today]="day.isToday">
            <div class="day-name">{{ day.dayName }}</div>
            <div class="day-number">{{ day.dayNumber }}</div>
          </div>

          <!-- Filas de horarios -->
          <ng-container *ngFor="let timeSlot of timeSlots; let i = index">
            <div class="time-slot-header">
              <div class="time-start">{{ timeSlot.time }}</div>
              <div class="time-duration">1.5h</div>
            </div>
            
            <div *ngFor="let day of currentWeek" 
                 class="calendar-cell"
                 [class]="getCellClassForCourtAndTime(court, day, timeSlot)"
                 (click)="onCellClickForCourtAndTime(court, day, timeSlot)"
                 [title]="getReservationInfoForCourtAndTime(court, day, timeSlot)">
              
              <div class="cell-content">
                <div class="cell-status">
                  <span *ngIf="isReservedForCourtAndTime(court, day, timeSlot)" class="reserved-indicator">
                    Ocupado
                  </span>
                  <span *ngIf="isAvailableForCourtAndTime(court, day, timeSlot)" class="available-indicator">
                    Disponible
                  </span>
                  <span *ngIf="!isAvailableForCourtAndTime(court, day, timeSlot) && !isReservedForCourtAndTime(court, day, timeSlot)" class="unavailable-indicator">
                    No disponible
                  </span>
                </div>
              </div>
            </div>
          </ng-container>
        </div>
      </div>
    </div>
  </div>

  <!-- Leyenda -->
  <div class="calendar-legend">
    <div class="legend-item">
      <div class="legend-color available"></div>
      <span>Disponible</span>
    </div>
    <div class="legend-item">
      <div class="legend-color reserved"></div>
      <span>Ocupado</span>
    </div>
    <div class="legend-item">
      <div class="legend-color unavailable"></div>
      <span>No disponible</span>
    </div>
  </div>

  <!-- Informaci√≥n adicional -->
  <div class="calendar-info">
    <p><strong>Instrucciones:</strong></p>
    <ul>
      <li>Cada bloque representa 1.5 horas de reserva</li>
      <li><strong>¬°Un solo click en una celda verde reserva autom√°ticamente!</strong></li>
      <li>Las celdas rojas est√°n ocupadas</li>
      <li>Las celdas grises no est√°n disponibles</li>
      <li>Solo se pueden reservar horarios futuros</li>
      <li>Tambi√©n puedes usar "Nueva Reserva" para m√°s opciones</li>
    </ul>
  </div>

  <!-- Notificaciones -->
  <div *ngIf="showNotification" class="notification" [class.success]="notificationType === 'success'" [class.error]="notificationType === 'error'">
    <div class="notification-content">
      <span class="notification-icon">
        {{ notificationType === 'success' ? '‚úÖ' : '‚ùå' }}
      </span>
      <span class="notification-message">{{ notificationMessage }}</span>
      <button class="notification-close" (click)="hideNotification()">√ó</button>
    </div>
  </div>

  <!-- Modal de confirmaci√≥n de reserva -->
  <div *ngIf="showReservationModal" class="modal-overlay" (click)="closeReservationModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>Confirmar Reserva</h3>
        <button class="close-btn" (click)="closeReservationModal()">√ó</button>
      </div>
      
      <div class="modal-body" *ngIf="getReservationSummary() as summary">
        <div class="reservation-details">
          <div class="detail-row">
            <span class="label">Cancha:</span>
            <span class="value">{{ summary.courtName }} ({{ summary.courtType }})</span>
          </div>
          
          <div class="detail-row">
            <span class="label">Fecha:</span>
            <span class="value">{{ summary.date }}</span>
          </div>
          
          <div class="detail-row">
            <span class="label">Horario:</span>
            <span class="value">{{ summary.startTime }} - {{ summary.endTime }}</span>
          </div>
          
          <div class="detail-row">
            <span class="label">Duraci√≥n:</span>
            <span class="value">{{ summary.duration }}</span>
          </div>
          
          <!-- Informaci√≥n de precios -->
          <div class="price-section">
            <div *ngIf="summary.isMember" class="member-benefit">
              <div class="member-icon">üëë</div>
              <div class="member-text">
                <strong>¬°Gratis para socios!</strong>
                <p>Como socio, no tienes costo por esta reserva</p>
              </div>
            </div>
            
            <div *ngIf="!summary.isMember" class="price-breakdown">
              <div class="price-row">
                <span>Precio base ({{ summary.duration }}):</span>
                <span>${{ summary.basePrice }}</span>
              </div>
              
              <div *ngIf="summary.hasLighting" class="price-row lighting">
                <span>Iluminaci√≥n (despu√©s de 17:00):</span>
                <span>${{ summary.lightingFee }}</span>
              </div>
              
              <div class="price-row total">
                <span><strong>Total:</strong></span>
                <span><strong>${{ summary.totalPrice }}</strong></span>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="modal-footer">
        <button class="btn-cancel" (click)="closeReservationModal()" [disabled]="isCreatingReservation">
          Cancelar
        </button>
        <button class="btn-confirm" (click)="confirmReservation()" [disabled]="isCreatingReservation">
          <span *ngIf="!isCreatingReservation">Confirmar Reserva</span>
          <span *ngIf="isCreatingReservation">Creando...</span>
        </button>
      </div>
    </div>
  </div>
</div>